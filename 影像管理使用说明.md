# 影像数据管理功能使用说明

## 快速开始

### 1. 启动后端服务

首先需要启动影像管理后端服务：

```bash
双击运行：启动影像管理服务.bat
```

启动成功后会看到：
```
服务器运行在 http://localhost:8080
数据目录：E:\webgis\webgis_project\public\data
```

### 2. 启动前端项目

```bash
双击运行：启动项目.bat
```

或者手动启动：
```bash
npm run dev
```

### 3. 访问影像管理页面

在浏览器中访问：`http://localhost:3000`

点击左侧菜单的"影像管理"进入影像数据管理页面。

## 主要功能

### 📤 上传影像

1. 点击"批量上传影像"按钮
2. 拖拽或点击选择 TIF 格式的影像文件
3. 支持多文件同时上传
4. 点击"开始上传"
5. 上传的文件会自动保存到 `public/data` 目录

**支持格式**: .tif, .tiff, .img, .jp2

### 🗑️ 删除影像

**单个删除**：
- 在表格中点击某条影像记录的"删除"按钮
- 确认后会永久删除该文件

**批量删除**：
1. 勾选需要删除的影像
2. 点击顶部"批量删除"按钮
3. 确认后会永久删除所有选中的文件

### 📥 下载影像

**单个下载**：
- 点击影像记录的"下载"按钮

**批量下载**：
1. 勾选需要下载的影像
2. 点击顶部"批量下载"按钮
3. 文件会依次下载到浏览器默认下载目录

### 🔍 搜索与筛选

**搜索**：
- 在搜索框输入影像名称或区域关键词
- 点击搜索按钮

**高级筛选**：
- **时间范围**: 选择开始和结束日期
- **传感器类型**: Sentinel-2、Landsat-8、高分系列
- **云量**: 拖动滑块设置云量阈值（≤ N%）

### 👁️ 预览影像

点击"预览"按钮可查看影像基本信息（功能待完善）

### 📊 视图模式

- **列表视图**: 详细的表格形式，适合查看完整信息
- **缩略图视图**: 卡片网格形式，适合浏览

## 数据说明

### 当前数据文件

项目中已包含以下示例数据：

1. `2024_kle_vh_kndvi.tif` - 2024年克拉玛依地区数据
2. `2025_kle_vh_kndvi_phase1.tif` - 2025年第一期数据
3. `2025_kle_vh_kndvi_phase2.tif` - 2025年第二期数据

### 数据属性说明

TIF 影像中的像素值代表不同的地物类型：

- 0 - 裸地
- 1 - 棉花
- 2 - 小麦
- 3 - 玉米
- 4 - 番茄
- 5 - 甜菜
- 6 - 打瓜
- 7 - 辣椒
- 8 - 籽用葫芦
- 9 - 其它耕地

### 数据组织方式

- 影像数据按年份组织
- 每年包含两期遥感数据
- 文件统一存储在 `public/data` 目录
- 元数据自动维护在 `imageData.json` 文件中

## 注意事项

### ⚠️ 重要提示

1. **删除操作不可恢复**：删除影像会永久删除文件，请谨慎操作
2. **先启动后端**：使用前必须先启动影像管理后端服务
3. **文件格式**：只支持指定的影像格式（.tif, .tiff, .img, .jp2）
4. **不影响其他功能**：影像管理功能独立运行，不会影响任务管理、结果对比等其他模块

### 📁 文件结构

```
webgis_project/
├── public/
│   └── data/              # 影像数据存储目录
│       ├── 2024_kle_vh_kndvi.tif
│       ├── 2025_kle_vh_kndvi_phase1.tif
│       ├── 2025_kle_vh_kndvi_phase2.tif
│       ├── imageData.json # 影像元数据
│       └── ReadMe.txt
├── server/                # 后端服务
│   ├── image-management-server.js
│   ├── package.json
│   └── README.md
└── src/
    └── views/
        └── ImageManagement/
            └── index.vue  # 影像管理页面
```

## 故障排除

### 问题：页面显示"加载影像列表失败"

**解决方案**：
1. 检查后端服务是否已启动
2. 查看浏览器控制台是否有错误信息
3. 确认端口8080未被占用

### 问题：上传失败

**解决方案**：
1. 检查文件格式是否支持
2. 确认 data 目录有写入权限
3. 检查文件大小是否合理（建议单个文件不超过2GB）

### 问题：删除后文件仍然存在

**解决方案**：
1. 刷新页面重新加载列表
2. 检查文件权限
3. 重启后端服务

## 技术支持

如有问题，请查看：
- `server/README.md` - 后端服务详细文档
- `问题解决方案.md` - 项目通用问题解决方案

