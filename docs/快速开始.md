# 快速开始指南

## 项目简介

新疆WebGIS监测与分析系统 - 基于Vue 3 + OpenLayers的遥感影像管理与分析平台。

## 环境要求

- Node.js >= 16
- Python 3.x (用于GDAL)
- GDAL (用于TIF优化)

## 快速启动

### 1. 前端启动

双击运行：`启动项目.bat`

或手动运行：
```bash
npm install
npm run dev
```

前端地址：http://localhost:5173

### 2. 后端启动

双击运行：`启动后端服务.bat`

或手动运行：
```bash
cd server
npm install
node app.js
```

后端地址：http://localhost:8080

## 主要功能

### 1. 控制台 (Dashboard)
- 影像选择与加载
- 多底图切换（高德路网、影像、纯净图）
- 作物分类图层显示
- 作物类型筛选
- 统计图表展示

### 2. 影像管理
- 影像上传
- 影像列表查看（表格/缩略图）
- 影像编辑
- 影像删除
- **TIF优化功能**（重要！）

### 3. 任务管理
- 识别任务创建
- 任务进度跟踪
- 结果导出

## TIF优化说明

### 为什么需要优化？

原始TIF文件存在的问题：
1. **坐标系不匹配**：原始数据使用EPSG:32645（UTM），Web地图使用EPSG:3857
2. **文件过大**：未压缩，加载缓慢
3. **NoData处理**：投影转换时填充区域被错误标记

### 优化脚本使用

#### 方法一：网页界面优化（推荐）
1. 进入"影像管理"页面
2. 找到未优化的文件
3. 点击"优化TIF"按钮
4. 等待处理完成（1-10分钟）

#### 方法二：手动运行脚本

**标准优化（推荐）**：
双击运行：`optimize_tif_shift.bat`

该脚本会：
- 将像素值整体+1（0→1, 1→2, ..., 9→10）
- 设置NoData=0
- 投影转换：EPSG:32645 → EPSG:3857
- 转换为COG格式（Cloud Optimized GeoTIFF）
- 添加金字塔（加速显示）

**处理后的像素值映射：**
```
0  = NoData（透明）
1  = 裸地（原0）
2  = 棉花（原1）
3  = 小麦（原2）
4  = 玉米（原3）
5  = 番茄（原4）
6  = 甜菜（原5）
7  = 打瓜（原6）
8  = 辣椒（原7）
9  = 籽用葫芦（原8）
10 = 其它耕地（原9）
```

### 优化效果

- ✅ 文件大小：71MB → 3-7MB（减少60-95%）
- ✅ 加载速度：提升10-20倍
- ✅ 坐标对齐：完美匹配底图
- ✅ NoData透明：填充区域正确显示为透明

## 数据目录

```
public/data/
  ├── imageData.json          # 影像元数据
  ├── 2024_kle_vh_kndvi.tif   # 原始TIF文件
  └── 2024_kle_vh_kndvi_optimized_shift.tif  # 优化后的文件
```

## 常见问题

### 1. 地图上影像有偏移？
**原因**：未进行投影转换
**解决**：使用优化脚本转换为EPSG:3857

### 2. 影像加载很慢？
**原因**：文件过大且未优化
**解决**：使用TIF优化功能

### 3. 非作物区域显示为裸地？
**原因**：NoData区域被错误填充为0
**解决**：使用`optimize_tif_shift.bat`脚本（像素值+1方法）

### 4. 刷新后选项未更新？
**解决**：点击"刷新选项"按钮重新加载数据

## 技术栈

**前端：**
- Vue 3 + Vite
- Element Plus
- OpenLayers 8
- ECharts 5
- Lucide Icons

**后端：**
- Node.js + Express
- GDAL（影像处理）

**地图：**
- 底图：高德地图
- 坐标系：EPSG:3857 (Web Mercator)

## 更多文档

- [GDAL完整指南](./GDAL完整指南.md)
- [TIF优化完整指南](./TIF优化完整指南.md)
- [功能使用指南](./功能使用指南.md)

## 支持

如有问题，请查看项目文档或联系开发团队。

